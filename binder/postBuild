#!/usr/bin/env bash
set -euo pipefail
PREFIX="/srv/conda/envs/notebook"

JS_CONF_D="$PREFIX/etc/jupyter/jupyter_server_config.d"
NB_D="$PREFIX/etc/jupyter/nbconfig/notebook.d"
mkdir -p "$JS_CONF_D" "$NB_D"

# Force nbclassic, disable Lab, and land on /classic/tree
cat > "$JS_CONF_D/000-ui.json" <<'JSON'
{
  "ServerApp": {
    "jpserver_extensions": {
      "jupyterlab": false,
      "nbclassic": true
    },
    "default_url": "/classic/tree"
  }
}
JSON

cat > "$NB_D/enable_extensions.json" <<'JSON'
{
  "load_extensions": {
    "toc2/main": true,
    "collapsible_headings/main": true,
    "execute_time/ExecuteTime": true,
    "hinterland/hinterland": true,
    "codefolding/main": true,
    "varInspector/main": true,
    "exercise2/main": true,
    "ruler/main": true,
    "scroll_down/main": true,
    "splitcell/main": true,
    "freeze/main": true
  }
}
JSON
